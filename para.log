Currently Loaded Modulefiles:
 1) slurm/slurm/23.02.4   2) nvidia-hpc/2024_241   3) nvhpc/24.1  
no change     /cm/shared/apps/anaconda/2024.02/condabin/conda
no change     /cm/shared/apps/anaconda/2024.02/bin/conda
no change     /cm/shared/apps/anaconda/2024.02/bin/conda-env
no change     /cm/shared/apps/anaconda/2024.02/bin/activate
no change     /cm/shared/apps/anaconda/2024.02/bin/deactivate
no change     /cm/shared/apps/anaconda/2024.02/etc/profile.d/conda.sh
no change     /cm/shared/apps/anaconda/2024.02/etc/fish/conf.d/conda.fish
no change     /cm/shared/apps/anaconda/2024.02/shell/condabin/Conda.psm1
no change     /cm/shared/apps/anaconda/2024.02/shell/condabin/conda-hook.ps1
no change     /cm/shared/apps/anaconda/2024.02/lib/python3.11/site-packages/xontrib/conda.xsh
no change     /cm/shared/apps/anaconda/2024.02/etc/profile.d/conda.csh
no change     /home/qmao.cs11/.bashrc
No action taken.

CondaError: Run 'conda init' before 'conda activate'

srun: error: DGX-CN02: task 0: Exited with exit code 1
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Loading LLM
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.12s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.11s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.01s/it]
Initialize KnowEnc with torch.bfloat16...
Initialize EncTunedLM...
Loading dataset...
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Running DDP on rank 2.
Running DDP on rank 0.
Running DDP on rank 1.
Running DDP on rank 3.
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/home/qmao.cs11/.conda/envs/RLR/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
epoch 0, iter   0, loss: 1.805/2.074
epoch 0, iter  50, loss: 2.060/2.707
epoch 0, iter 100, loss: 2.137/2.129
epoch 0, iter 150, loss: 2.131/2.166
epoch 0, iter 200, loss: 2.012/2.093
epoch 0, iter 250, loss: 1.909/1.585
epoch 0, iter 300, loss: 1.791/1.743
epoch 0, iter 350, loss: 1.725/1.683
epoch 0, iter 400, loss: 1.679/1.786
epoch 0, iter 450, loss: 1.653/1.680
epoch 0, iter 500, loss: 1.643/1.423
epoch 0, iter 550, loss: 1.649/1.472
epoch 0, iter 600, loss: 1.615/1.596
epoch 0, iter 650, loss: 1.628/1.705
epoch 0, iter 700, loss: 1.622/1.391
epoch 0, iter 750, loss: 1.626/1.667
epoch 0, iter 800, loss: 1.629/1.481
epoch 0, iter 850, loss: 1.605/1.637
epoch 0, iter 900, loss: 1.622/1.587
epoch 0, iter 950, loss: 1.630/1.501
epoch 0, iter 1000, loss: 1.614/1.754
epoch 0, iter 1050, loss: 1.634/1.787
epoch 0, iter 1100, loss: 1.613/1.541
epoch 0, iter 1150, loss: 1.603/1.513
epoch 0, iter 1200, loss: 1.615/1.787
epoch 0, iter 1250, loss: 1.605/1.658
epoch 0, iter 1300, loss: 1.610/1.471
epoch 0, iter 1350, loss: 1.589/1.490
epoch 0, iter 1400, loss: 1.577/1.704
epoch 0, iter 1450, loss: 1.565/1.547
epoch 0, iter 1500, loss: 1.571/1.568
epoch 0, iter 1550, loss: 1.569/1.629
epoch 0, iter 1600, loss: 1.576/1.317
epoch 0, iter 1650, loss: 1.579/1.507
epoch 0, iter 1700, loss: 1.563/1.560
epoch 0, iter 1750, loss: 1.549/1.518
epoch 0, iter 1800, loss: 1.545/1.389
epoch 0, iter 1850, loss: 1.556/1.493
epoch 0, iter 1900, loss: 1.538/1.521
epoch 0, iter 1950, loss: 1.539/1.321
epoch 0, iter 2000, loss: 1.519/1.421
epoch 0, iter 2050, loss: 1.520/1.446
epoch 0, iter 2100, loss: 1.533/1.660
epoch 0, iter 2150, loss: 1.516/1.660
epoch 0, iter 2200, loss: 1.522/1.638
epoch 0, iter 2250, loss: 1.509/1.576
epoch 0, iter 2300, loss: 1.534/1.408
epoch 0, iter 2350, loss: 1.489/1.496
epoch 0, iter 2400, loss: 1.490/1.632
epoch 0, iter 2450, loss: 1.490/1.602
epoch 0, iter 2500, loss: 1.490/1.673
epoch 0, iter 2550, loss: 1.501/1.749
epoch 0, iter 2600, loss: 1.506/1.618
epoch 0, iter 2650, loss: 1.474/1.309
epoch 0, iter 2700, loss: 1.486/1.588
epoch 0, iter 2750, loss: 1.479/1.395
epoch 0, iter 2800, loss: 1.507/1.607
epoch 0, iter 2850, loss: 1.481/1.470
epoch 0, iter 2900, loss: 1.506/1.620
epoch 0, iter 2950, loss: 1.488/1.395
epoch 0, iter 3000, loss: 1.467/1.589
epoch 0, iter 3050, loss: 1.482/1.322
epoch 0, iter 3100, loss: 1.474/1.548
epoch 0, iter 3150, loss: 1.485/1.629
epoch 0, iter 3200, loss: 1.498/1.209
epoch 0, iter 3250, loss: 1.469/1.388
epoch 0, iter 3300, loss: 1.469/1.348
epoch 0, iter 3350, loss: 1.465/1.370
epoch 0, iter 3400, loss: 1.469/1.349
epoch 0, iter 3450, loss: 1.456/1.234
epoch 0, iter 3500, loss: 1.469/1.382
epoch 0, iter 3550, loss: 1.470/1.569
epoch 0, iter 3600, loss: 1.470/1.410
epoch 0, iter 3650, loss: 1.451/1.561
epoch 0, iter 3700, loss: 1.447/1.477
epoch 0, iter 3750, loss: 1.475/1.458
epoch 0, iter 3800, loss: 1.476/1.443
epoch 0, iter 3850, loss: 1.458/1.366
epoch 0, iter 3900, loss: 1.462/1.539
epoch 0, iter 3950, loss: 1.483/1.753
epoch 0, iter 4000, loss: 1.449/1.568
epoch 0, iter 4050, loss: 1.466/1.529
epoch 0, iter 4100, loss: 1.448/1.376
epoch 0, iter 4150, loss: 1.460/1.573
epoch 0, iter 4200, loss: 1.467/1.613
epoch 0, iter 4250, loss: 1.442/1.470
epoch 0, iter 4300, loss: 1.469/1.535
epoch 0, iter 4350, loss: 1.467/1.574
epoch 0, iter 4400, loss: 1.449/1.210
epoch 0, iter 4450, loss: 1.485/1.432
epoch 0, iter 4500, loss: 1.430/1.374
epoch 0, iter 4550, loss: 1.471/1.410
epoch 0, iter 4600, loss: 1.451/1.202
epoch 0, iter 4650, loss: 1.471/1.437
epoch 0, iter 4700, loss: 1.475/1.513
epoch 0, iter 4750, loss: 1.456/1.588
epoch 0, iter 4800, loss: 1.461/1.604
epoch 0, iter 4850, loss: 1.453/1.237
epoch 0, iter 4900, loss: 1.463/1.703
epoch 0, iter 4950, loss: 1.475/1.582
epoch 0, iter 5000, loss: 1.441/1.380
epoch 0, iter 5050, loss: 1.436/1.143
epoch 0, iter 5100, loss: 1.469/1.642
epoch 0, iter 5150, loss: 1.446/1.360
epoch 0, iter 5200, loss: 1.442/1.318
epoch 0, iter 5250, loss: 1.439/1.470
epoch 0, iter 5300, loss: 1.446/1.588
epoch 0, iter 5350, loss: 1.449/1.475
epoch 0, iter 5400, loss: 1.460/1.720
epoch 0, iter 5450, loss: 1.433/1.157
epoch 0, iter 5500, loss: 1.429/1.346
epoch 0, iter 5550, loss: 1.421/1.331
epoch 0, iter 5600, loss: 1.441/1.416
epoch 0, iter 5650, loss: 1.422/1.498
epoch 0, iter 5700, loss: 1.430/1.587
epoch 0, iter 5750, loss: 1.438/1.619
epoch 0, iter 5800, loss: 1.437/1.280
epoch 0, iter 5850, loss: 1.441/1.612
epoch 0, iter 5900, loss: 1.436/1.278
epoch 0, iter 5950, loss: 1.427/1.505
epoch 0, iter 6000, loss: 1.439/1.513
epoch 0, iter 6050, loss: 1.437/1.343
epoch 0, iter 6100, loss: 1.450/1.501
epoch 0, iter 6150, loss: 1.428/1.140
epoch 1, iter   0, loss: 1.423/1.302
epoch 1, iter  50, loss: 1.430/1.397
epoch 1, iter 100, loss: 1.446/1.542
epoch 1, iter 150, loss: 1.440/1.707
epoch 1, iter 200, loss: 1.436/1.446
epoch 1, iter 250, loss: 1.444/1.507
epoch 1, iter 300, loss: 1.427/1.352
epoch 1, iter 350, loss: 1.418/1.374
epoch 1, iter 400, loss: 1.427/1.070
epoch 1, iter 450, loss: 1.444/1.394
epoch 1, iter 500, loss: 1.449/1.615
epoch 1, iter 550, loss: 1.417/1.301
epoch 1, iter 600, loss: 1.442/1.662
epoch 1, iter 650, loss: 1.420/1.460
epoch 1, iter 700, loss: 1.421/1.546
epoch 1, iter 750, loss: 1.432/1.390
epoch 1, iter 800, loss: 1.454/1.503
epoch 1, iter 850, loss: 1.439/1.575
epoch 1, iter 900, loss: 1.423/1.761
epoch 1, iter 950, loss: 1.434/1.444
epoch 1, iter 1000, loss: 1.416/1.434
epoch 1, iter 1050, loss: 1.415/1.432
epoch 1, iter 1100, loss: 1.416/1.591
epoch 1, iter 1150, loss: 1.410/1.208
epoch 1, iter 1200, loss: 1.408/1.354
epoch 1, iter 1250, loss: 1.419/1.262
epoch 1, iter 1300, loss: 1.417/1.442
epoch 1, iter 1350, loss: 1.412/1.512
epoch 1, iter 1400, loss: 1.428/1.503
epoch 1, iter 1450, loss: 1.431/1.403
epoch 1, iter 1500, loss: 1.423/1.428
epoch 1, iter 1550, loss: 1.418/1.375
epoch 1, iter 1600, loss: 1.404/1.425
epoch 1, iter 1650, loss: 1.412/1.479
epoch 1, iter 1700, loss: 1.426/1.265
epoch 1, iter 1750, loss: 1.427/1.521
epoch 1, iter 1800, loss: 1.421/1.591
epoch 1, iter 1850, loss: 1.423/1.269
epoch 1, iter 1900, loss: 1.429/1.630
epoch 1, iter 1950, loss: 1.430/1.415
epoch 1, iter 2000, loss: 1.433/1.442
epoch 1, iter 2050, loss: 1.425/1.629
epoch 1, iter 2100, loss: 1.448/1.568
epoch 1, iter 2150, loss: 1.417/1.534
epoch 1, iter 2200, loss: 1.423/1.434
epoch 1, iter 2250, loss: 1.419/1.435
epoch 1, iter 2300, loss: 1.415/1.594
epoch 1, iter 2350, loss: 1.419/1.650
epoch 1, iter 2400, loss: 1.440/1.443
epoch 1, iter 2450, loss: 1.421/1.464
epoch 1, iter 2500, loss: 1.415/1.347
epoch 1, iter 2550, loss: 1.404/1.420
epoch 1, iter 2600, loss: 1.436/1.589
epoch 1, iter 2650, loss: 1.406/1.369
epoch 1, iter 2700, loss: 1.414/1.539
epoch 1, iter 2750, loss: 1.407/1.688
epoch 1, iter 2800, loss: 1.444/1.653
epoch 1, iter 2850, loss: 1.427/1.298
epoch 1, iter 2900, loss: 1.429/1.599
epoch 1, iter 2950, loss: 1.419/1.584
epoch 1, iter 3000, loss: 1.404/1.405
epoch 1, iter 3050, loss: 1.397/1.357
epoch 1, iter 3100, loss: 1.414/1.405
epoch 1, iter 3150, loss: 1.436/1.299
epoch 1, iter 3200, loss: 1.439/1.684
epoch 1, iter 3250, loss: 1.441/1.299
epoch 1, iter 3300, loss: 1.431/1.382
epoch 1, iter 3350, loss: 1.406/1.608
epoch 1, iter 3400, loss: 1.422/1.602
epoch 1, iter 3450, loss: 1.419/1.459
epoch 1, iter 3500, loss: 1.414/1.366
epoch 1, iter 3550, loss: 1.418/1.296
epoch 1, iter 3600, loss: 1.430/1.569
epoch 1, iter 3650, loss: 1.414/1.201
epoch 1, iter 3700, loss: 1.404/1.419
epoch 1, iter 3750, loss: 1.397/1.437
epoch 1, iter 3800, loss: 1.418/1.330
epoch 1, iter 3850, loss: 1.418/1.537
epoch 1, iter 3900, loss: 1.398/1.314
epoch 1, iter 3950, loss: 1.409/1.176
epoch 1, iter 4000, loss: 1.397/1.366
epoch 1, iter 4050, loss: 1.404/1.260
epoch 1, iter 4100, loss: 1.422/1.570
epoch 1, iter 4150, loss: 1.440/1.294
epoch 1, iter 4200, loss: 1.436/1.275
epoch 1, iter 4250, loss: 1.400/1.305
epoch 1, iter 4300, loss: 1.415/1.295
epoch 1, iter 4350, loss: 1.428/1.411
epoch 1, iter 4400, loss: 1.396/1.307
epoch 1, iter 4450, loss: 1.403/1.272
epoch 1, iter 4500, loss: 1.414/1.501
epoch 1, iter 4550, loss: 1.393/1.295
epoch 1, iter 4600, loss: 1.412/1.407
epoch 1, iter 4650, loss: 1.422/1.435
epoch 1, iter 4700, loss: 1.426/1.286
epoch 1, iter 4750, loss: 1.416/1.644
epoch 1, iter 4800, loss: 1.397/1.372
epoch 1, iter 4850, loss: 1.394/1.500
epoch 1, iter 4900, loss: 1.387/1.603
epoch 1, iter 4950, loss: 1.411/1.219
epoch 1, iter 5000, loss: 1.372/1.406
epoch 1, iter 5050, loss: 1.380/1.484
epoch 1, iter 5100, loss: 1.405/1.339
epoch 1, iter 5150, loss: 1.394/1.669
epoch 1, iter 5200, loss: 1.405/1.390
epoch 1, iter 5250, loss: 1.402/1.472
epoch 1, iter 5300, loss: 1.391/1.420
epoch 1, iter 5350, loss: 1.403/1.409
epoch 1, iter 5400, loss: 1.404/1.518
epoch 1, iter 5450, loss: 1.385/1.418
epoch 1, iter 5500, loss: 1.388/1.326
epoch 1, iter 5550, loss: 1.391/1.568
epoch 1, iter 5600, loss: 1.415/1.219
epoch 1, iter 5650, loss: 1.420/1.577
epoch 1, iter 5700, loss: 1.396/1.276
epoch 1, iter 5750, loss: 1.403/1.324
epoch 1, iter 5800, loss: 1.398/1.589
epoch 1, iter 5850, loss: 1.399/1.482
epoch 1, iter 5900, loss: 1.397/1.298
epoch 1, iter 5950, loss: 1.406/1.345
epoch 1, iter 6000, loss: 1.393/1.375
epoch 1, iter 6050, loss: 1.397/1.699
epoch 1, iter 6100, loss: 1.371/1.062
epoch 1, iter 6150, loss: 1.404/1.552
